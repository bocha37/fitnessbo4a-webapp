<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ë–ñ–£</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script> 
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"  rel="stylesheet">
</head>
<body class="bg-gray-100 min-h-screen p-6">
  <div class="bg-white rounded-xl shadow-lg w-full max-w-md mx-auto p-6">
    <h2 class="text-2xl font-bold text-center text-green-600 mb-6">üßÆ –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ë–ñ–£</h2>
    <form id="bjuForm" class="space-y-4">
      <input type="number" name="weight" placeholder="–í–µ—Å (–∫–≥)" required
             class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500" />

      <input type="number" name="height" placeholder="–†–æ—Å—Ç (—Å–º)" required
             class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500" />

      <input type="number" name="age" placeholder="–í–æ–∑—Ä–∞—Å—Ç" required
             class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500" />

      <select name="gender" required
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª</option>
        <option value="male">–ú—É–∂—Å–∫–æ–π</option>
        <option value="female">–ñ–µ–Ω—Å–∫–∏–π</option>
      </select>

      <select name="activity" required
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
        <option value="">–£—Ä–æ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</option>
        <option value="1.2">–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</option>
        <option value="1.375">–õ–µ–≥–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (1‚Äì3 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é)</option>
        <option value="1.55">–°—Ä–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (3‚Äì5 —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é)</option>
        <option value="1.725">–í—ã—Å–æ–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (6‚Äì7 —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é)</option>
        <option value="1.9">–û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</option>
      </select>

      <select name="goal" required
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ü–µ–ª—å</option>
        <option value="lose">–ü–æ—Ö—É–¥–µ–Ω–∏–µ</option>
        <option value="maintain">–£–¥–µ—Ä–∂–∞–Ω–∏–µ –≤–µ—Å–∞</option>
        <option value="gain">–ù–∞–±–æ—Ä –º–∞—Å—Å—ã</option>
      </select>

      <button type="submit"
              class="w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-4 rounded-lg transition duration-200">
        –†–∞—Å—Å—á–∏—Ç–∞—Ç—å
      </button>
    </form>

    <div id="result" class="mt-6 text-center hidden">
      <p class="font-medium">–í–∞—à–∞ –Ω–æ—Ä–º–∞:</p>
      <p class="text-blue-600">–ö–∞–ª–æ—Ä–∏–∏: <span id="calories"></span></p>
      <p class="text-red-600">–ë–µ–ª–∫–∏: <span id="proteins"></span> –≥</p>
      <p class="text-yellow-600">–ñ–∏—Ä—ã: <span id="fats"></span> –≥</p>
      <p class="text-blue-400">–£–≥–ª–µ–≤–æ–¥—ã: <span id="carbs"></span> –≥</p>
      <div id="ration" class="mt-4 text-left text-sm text-gray-700"></div>
      <button id="showPlanButton" class="mt-4 w-full bg-indigo-600 hover:bg-indigo-700 text-white py-2 px-4 rounded-lg hidden">
        –•–æ—á—É –ø–ª–∞–Ω –ø–∏—Ç–∞–Ω–∏—è –Ω–∞ –Ω–µ–¥–µ–ª—é
      </button>
    </div>
  </div>

  <script>
    document.getElementById("bjuForm").addEventListener("submit", async function(e) {
      e.preventDefault();
      const formData = new FormData(this);
      const weight = parseFloat(formData.get("weight"));
      const height = parseFloat(formData.get("height"));
      const age = parseInt(formData.get("age"));
      const gender = formData.get("gender");
      const activity = parseFloat(formData.get("activity"));
      const goal = formData.get("goal");

      if (!weight || !height || !age || !gender || !activity || !goal) {
        alert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è");
        return;
      }

      let bmr = gender === "male"
        ? 10 * weight + 6.25 * height - 5 * age + 5
        : 10 * weight + 6.25 * height - 5 * age - 161;

      let calories = Math.round(bmr * activity);

      // –ü—Ä–∏–º–µ–Ω—è–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ü–µ–ª–∏
      switch(goal) {
        case "lose":
          calories = Math.round(calories * 0.8); // -20%
          break;
        case "maintain":
          // –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
          break;
        case "gain":
          calories = Math.round(calories * 1.15); // +15%
          break;
      }

      const proteins = Math.round(weight * 1.6); // 1.6 –≥ –Ω–∞ –∫–≥
      const fats = Math.round(weight * 0.8);     // 0.8 –≥ –Ω–∞ –∫–≥
      const carbs = Math.round((calories - proteins * 4 - fats * 9) / 4);

      document.getElementById("calories").textContent = calories;
      document.getElementById("proteins").textContent = proteins;
      document.getElementById("fats").textContent = fats;
      document.getElementById("carbs").textContent = carbs;

      const rationDiv = document.getElementById("ration");

      let rationText = `<strong>–ü—Ä–∏–º–µ—Ä —Ä–∞—Ü–∏–æ–Ω–∞ (${goal === 'lose' ? '–ø–æ—Ö—É–¥–µ–Ω–∏–µ' : goal === 'gain' ? '–Ω–∞–±–æ—Ä –º–∞—Å—Å—ã' : '—É–¥–µ—Ä–∂–∞–Ω–∏–µ'})</strong><br/>`;

      switch(goal) {
        case "lose":
          rationText += `
            ü•£ –ó–∞–≤—Ç—Ä–∞–∫: –û–≤—Å—è–Ω–∫–∞ –Ω–∞ –≤–æ–¥–µ + —è–≥–æ–¥—ã (~250 –∫–∫–∞–ª)<br/>
            üçé –ü–µ—Ä–µ–∫—É—Å: –Ø–±–ª–æ–∫–æ (~70 –∫–∫–∞–ª)<br/>
            ü•ó –û–±–µ–¥: –ì—Ä—É–¥–∫–∞ –∫—É—Ä–∏–Ω–∞—è + –æ–≤–æ—â–∏ + –≥—Ä–µ—á–∫–∞ (~350 –∫–∫–∞–ª)<br/>
            üßÄ –ü–æ–ª–¥–Ω–∏–∫: –¢–≤–æ—Ä–æ–≥ –Ω–µ–∂–∏—Ä–Ω—ã–π (~100 –∫–∫–∞–ª)<br/>
            ü•¶ –£–∂–∏–Ω: –§–æ—Ä–µ–ª—å –Ω–∞ –≥—Ä–∏–ª–µ + –±—Ä–æ–∫–∫–æ–ª–∏ (~300 –∫–∫–∞–ª)<br/>
            ü•§ –í–æ–¥–∞ / —á–∞–π ‚Äî –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å
          `;
          break;

        case "maintain":
          rationText += `
            ü•£ –ó–∞–≤—Ç—Ä–∞–∫: –ì—Ä–µ—á–∫–∞ —Å —è–π—Ü–æ–º –∏ –æ–≤–æ—â–∞–º–∏ (~350 –∫–∫–∞–ª)<br/>
            üçå –ü–µ—Ä–µ–∫—É—Å: –ë–∞–Ω–∞–Ω (~100 –∫–∫–∞–ª)<br/>
            üç≤ –û–±–µ–¥: –°—É–ø –∏–∑ —á–µ—á–µ–≤–∏—Ü—ã + —Ü–µ–ª—å–Ω–æ–∑–µ—Ä–Ω–æ–≤–æ–π —Ö–ª–µ–± (~400 –∫–∫–∞–ª)<br/>
            üßÄ –ü–æ–ª–¥–Ω–∏–∫: –ô–æ–≥—É—Ä—Ç + –æ—Ä–µ—Ö–∏ (~200 –∫–∫–∞–ª)<br/>
            üçó –£–∂–∏–Ω: –ò–Ω–¥–µ–π–∫–∞ + –∫–∞—Ä—Ç–æ—Ñ–µ–ª—å + –∑–µ–ª–µ–Ω—å (~400 –∫–∫–∞–ª)
          `;
          break;

        case "gain":
          rationText += `
            ü•ì –ó–∞–≤—Ç—Ä–∞–∫: –Ø–∏—á–Ω–∏—Ü–∞ + —Ç–æ—Å—Ç—ã + –∞–≤–æ–∫–∞–¥–æ (~500 –∫–∫–∞–ª)<br/>
            üçå –ü–µ—Ä–µ–∫—É—Å: –ë–∞–Ω–∞–Ω + –∞—Ä–∞—Ö–∏—Å–æ–≤–∞—è –ø–∞—Å—Ç–∞ (~300 –∫–∫–∞–ª)<br/>
            ü•¶ –û–±–µ–¥: –ì–æ–≤—è–¥–∏–Ω–∞ + —Ä–∏—Å + –æ–≤–æ—â–∏ (~600 –∫–∫–∞–ª)<br/>
            ü•õ –ö–æ–∫—Ç–µ–π–ª—å: –ú–æ–ª–æ–∫–æ + –±–∞–Ω–∞–Ω + –ø—Ä–æ—Ç–µ–∏–Ω (~400 –∫–∫–∞–ª)<br/>
            üçû –£–∂–∏–Ω: –õ–æ—Å–æ—Å—å + –∫–∏–Ω–æ–∞ + —à–ø–∏–Ω–∞—Ç (~500 –∫–∫–∞–ª)
          `;
          break;
      }

      rationDiv.innerHTML = rationText;

      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
      const planButton = document.getElementById("showPlanButton");
      planButton.classList.remove("hidden");
      document.getElementById("result").classList.remove("hidden");
    });

    // –ù–∞–∂–∞—Ç–∏–µ –Ω–∞ –∫–Ω–æ–ø–∫—É "–•–æ—á—É –ø–ª–∞–Ω –ø–∏—Ç–∞–Ω–∏—è –Ω–∞ –Ω–µ–¥–µ–ª—é"
    document.getElementById("showPlanButton").addEventListener("click", () => {
      // –ú–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –¥—Ä—É–≥—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É WebApp
      window.location.href = "/week-plan.html"; // –∏–ª–∏ –≤–Ω–µ—à–Ω–∏–π URL: "https://fitnessbo4a-webapp.vercel.app/week-plan.html" 

      // –õ–∏–±–æ –æ—Ç–∫—Ä—ã—Ç—å Telegram-–±–æ—Ç–∞ —Å —Ñ–æ—Ä–º–æ–π:
      // window.location.href = "https://t.me/your_bot_username?start=plan";
    });
  </script>
</body>
</html>